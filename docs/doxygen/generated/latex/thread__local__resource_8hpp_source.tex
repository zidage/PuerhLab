\doxysection{thread\+\_\+local\+\_\+resource.\+hpp}
\hypertarget{thread__local__resource_8hpp_source}{}\label{thread__local__resource_8hpp_source}\index{D:/Projects/pu-\/erh\_lab/pu-\/erh\_lab/src/include/concurrency/thread\_local\_resource.hpp@{D:/Projects/pu-\/erh\_lab/pu-\/erh\_lab/src/include/concurrency/thread\_local\_resource.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ thread\_local\_resource.hpp}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ <functional>}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ <memory>}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ <mutex>}}
\DoxyCodeLine{00006\ }
\DoxyCodeLine{00007\ \textcolor{comment}{//\ 可泛化给任何类型\ T}}
\DoxyCodeLine{00008\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00009\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_thread_local_resource}{ThreadLocalResource}}\ \{}
\DoxyCodeLine{00010\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00011\ \ \ \textcolor{keyword}{using\ }Initializer\ =\ std::function<std::unique\_ptr<T>()>;}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ SetInitializer(Initializer\ init)\ \{\ GetInitFunc()\ =\ std::move(init);\ \}}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00015\ \ \ \textcolor{keyword}{static}\ T\&\ \ \ Get()\ \{}
\DoxyCodeLine{00016\ \ \ \ \ \textcolor{keyword}{thread\_local}\ std::unique\_ptr<T>\ instance\ =\ GetInitFunc()();}
\DoxyCodeLine{00017\ \ \ \ \ \textcolor{keywordflow}{return}\ *instance;}
\DoxyCodeLine{00018\ \ \ \}}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00021\ \ \ \textcolor{keyword}{static}\ Initializer\&\ GetInitFunc()\ \{}
\DoxyCodeLine{00022\ \ \ \ \ \textcolor{keyword}{static}\ Initializer\ init\_func;}
\DoxyCodeLine{00023\ \ \ \ \ \textcolor{keywordflow}{return}\ init\_func;}
\DoxyCodeLine{00024\ \ \ \}}
\DoxyCodeLine{00025\ \};}

\end{DoxyCode}
